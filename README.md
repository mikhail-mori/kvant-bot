# Кванториум Бот

## Описание проекта

Кванториум Бот — это многофункциональная система управления, объединяющая ботов для Telegram и VK с серверной частью на Flask. Проект предназначен для автоматизации взаимодействия с пользователями через мессенджеры, предоставления информации, обработки запросов и управления контентом.

---

## Структура проекта

```bash
.
├── api/                       # Серверная часть и логика бота
│   ├── templates/             # HTML-шаблоны Flask
│   │   ├── index.html         # Страница авторизации
│   │   └── data-control.html  # Админ-панель
│   ├── api.py                 # Основной Flask-сервер
│   ├── config.py              # Конфигурация приложения
│   ├── database.py            # Работа с базой данных
│   ├── functions.py           # Вспомогательные функции
│   ├── handlers.py            # Обработчики команд
│   └── keyboards.py           # Генерация клавиатур
│
├── clients/                   # Клиенты для мессенджеров
│   ├── vk.py                  # Интеграция с VK
│   └── telegram.py            # Интеграция с Telegram
│
├── databases/                 # Базы данных SQLite
│   ├── info.db                # Данные о квантумах/менторах
│   └── users.db               # Данные пользователей
│
├── static/                    # Статические файлы
│   └── uploads/               # Загруженные изображения
│       └── uploaded_pic.png   # Пример файла
│
├── .env                       # Конфигурация окружения
├── logs.log                   # Файл логов
├── README.md                  # Эта документация
├── requirements.txt           # Библиотеки Python необходимые для работы приложения
└── main.py                    # Точка входа и запуска всех клиентов и сервера
```

---

## Установка и настройка

### 1. Клонирование репозитория

Склонируйте репозиторий на ваш компьютер:

```bash
git clone https://github.com/your-repo/kvantorium-bot.git
cd kvantorium-bot
```

### 2. Настройка виртуального окружения

Убедитесь, что у вас установлен Python 3.8 или выше. Создайте и активируйте виртуальное окружение:

```bash
python -m venv venv
source venv/bin/activate  # Для Linux/MacOS
venv\Scripts\activate     # Для Windows
```

### 3. Установка зависимостей

Установите необходимые зависимости из файла `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 4. Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта и добавьте следующие переменные:

```bash
DEBUG=True
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
VK_BOT_TOKEN=your_vk_bot_token
FLASK_SECRET_KEY=your_flask_secret_key
DATABASE_URL=sqlite:///databases/users.db
API_URL=http://127.0.0.1:5000/api/message
```

Замените значения на ваши токены и ключи.

### 5. Запуск проекта

Запустите проект с помощью команды:

```bash
python main.py
```

При первом запуске скрипт автоматически создаст виртуальное окружение, установит зависимости и запустит все компоненты (Flask-сервер, Telegram-бот и VK-бот).

---

## Компоненты системы

### 1. **Telegram-бот**

- Реализован с использованием библиотеки `aiogram`.
- Обрабатывает команды, текстовые сообщения и нажатия на кнопки.
- Поддерживает отправку изображений, текстовых сообщений и клавиатур.

#### Пример ответа API для Telegram:
```json
{
    "text": "Привет! Вот изображение:",
    "file": "static/uploads/uploaded_pic.png",
    "keyboard": {
        "buttons": [
            [
                {"action": {"type": "text", "label": "Кнопка 1", "callback_data": "button_1"}}
            ],
            [
                {"action": {"type": "link", "label": "Ссылка", "link": "https://example.com"}}
            ]
        ]
    }
}
```

### 2. **VK-бот**

- Реализован с использованием библиотеки `vk_api`.
- Обрабатывает входящие сообщения, отправляет изображения, текстовые сообщения и клавиатуры.
- Поддерживает кнопки с ссылками и текстовые кнопки.

#### Пример ответа API для VK:
```json
{
    "text": "Привет! Вот изображение:",
    "file": "static/uploads/uploaded_pic.png",
    "keyboard": {
        "buttons": [
            [
                {"action": {"type": "text", "label": "Кнопка 1", "color": "primary"}}
            ],
            [
                {"action": {"type": "link", "label": "Ссылка", "link": "https://example.com"}}
            ]
        ]
    }
}
```

### 3. **Flask-сервер**

- Обрабатывает запросы от ботов.
- Хранит и управляет данными пользователей в базе данных SQLite.
- Предоставляет админ-панель для управления контентом.

#### Админ-панель:
Доступна по адресу `/admin`. Требует авторизации.

---

## Логирование

Все ошибки и события записываются в файл `logs.log`. Это помогает отслеживать работу системы и диагностировать проблемы.

---

## Требования

- Python 3.8+
- Библиотеки из `requirements.txt`:
  - `aiogram`
  - `vk_api`
  - `flask`
  - `sqlalchemy`
  - `dotenv`

---